<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Safe Host & TCP Port Checker (LAN-enabled)</title>
<style>
  body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:20px;background:#f6f8fb}
  .card{max-width:980px;margin:0 auto;background:#fff;padding:16px;border-radius:12px;box-shadow:0 8px 24px rgba(15,23,42,0.06)}
  input, button {padding:8px;border-radius:8px;border:1px solid #ddd}
  button{background:#0b5fff;color:#fff;border:0;cursor:pointer}
  .row{display:flex;gap:8px;align-items:center;margin-bottom:8px}
  pre{background:#0f1724;color:#e6eef8;padding:12px;border-radius:8px;overflow:auto;max-height:420px}
  .note{background:#fff4cc;padding:8px;border-radius:8px;border:1px solid #f0dca3;margin-bottom:12px}
</style>
</head>
<body>
  <div class="card">
    <h2>Safe Host & TCP Port Checker â€” LAN-enabled</h2>
    <div class="note">
      <strong>Important:</strong> Only use this tool inside your own LAN or with explicit permission.
    </div>

    <h4>Single Port Check</h4>
    <div class="row">
      <input id="host" placeholder="Host (IP or hostname)" style="flex:1">
      <input id="port" placeholder="port (e.g., 80)" style="width:120px">
      <input id="apikey" placeholder="API key" style="width:200px">
      <button id="checkBtn">Check TCP Port</button>
    </div>

    <h4>Range Scan</h4>
    <div class="row">
      <input id="host2" placeholder="Host (IP or hostname)" style="flex:1">
      <input id="start" placeholder="start port" style="width:100px">
      <input id="end" placeholder="end port" style="width:100px">
      <input id="apikey2" placeholder="API key" style="width:200px">
      <button id="scanBtn">Scan Range</button>
    </div>

    <div style="margin-top:12px">
      <pre id="out">Results will appear here</pre>
    </div>
  </div>

<script>
const out = document.getElementById('out');

document.getElementById('checkBtn').addEventListener('click', async () => {
  const host = document.getElementById('host').value.trim();
  const port = document.getElementById('port').value.trim();
  const apiKey = document.getElementById('apikey').value.trim();
  if (!host || !port || !apiKey) { out.textContent = 'Please enter host, port and key'; return; }
  out.textContent = 'Checking...';
  try {
    const r = await fetch('/tcp/check?host='+encodeURIComponent(host)+'&port='+encodeURIComponent(port), { headers: { "x-api-key": apiKey } });
    const j = await r.json();
    out.textContent = JSON.stringify(j, null, 2);
  } catch (e) {
    out.textContent = 'Error: ' + e.message;
  }
});

document.getElementById('scanBtn').addEventListener('click', async () => {
  const host = document.getElementById('host2').value.trim();
  const start = document.getElementById('start').value.trim();
  const end = document.getElementById('end').value.trim();
  const apiKey = document.getElementById('apikey2').value.trim();
  if (!host || !start || !end || !apiKey) { out.textContent = 'Please enter host, range and key'; return; }
  out.textContent = 'Scanning...';
  try {
    const r = await fetch('/tcp/scan-range', {
      method: 'POST',
      headers: { "Content-Type":"application/json", "x-api-key": apiKey },
      body: JSON.stringify({ host, start: Number(start), end: Number(end) })
    });
    const j = await r.json();
    out.textContent = JSON.stringify(j, null, 2);
  } catch (e) {
    out.textContent = 'Error: ' + e.message;
  }
});
</script>
</body>
</html>
